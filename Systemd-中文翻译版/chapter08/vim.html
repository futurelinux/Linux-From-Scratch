<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      8.69.&nbsp;Vim-8.2.1361
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="lfs" id="lfs-20200927-systemd，中文翻译版">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 20200927-systemd，中文翻译版
      </h4>
      <h3>
        第&nbsp;8&nbsp;章&nbsp;安装基本系统软件
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="texinfo.html" title="Texinfo-6.7">上一页</a>
          <p>
            Texinfo-6.7
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="systemd.html" title="Systemd-246">下一页</a>
          <p>
            Systemd-246
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter08.html" title=
          "第&nbsp;8&nbsp;章&nbsp;安装基本系统软件">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200927-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
    <div class="wrap" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-system-vim" name="ch-system-vim"></a>8.69. Vim-8.2.1361
      </h1>
      <div class="package" lang="zh-cn" xml:lang="zh-cn">
        <p>
          Vim 软件包包含强大的文本编辑器。
        </p>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">估计构建时间:</strong> <span class=
              "segbody">2.2 SBU</span>
            </div>
            <div class="seg">
              <strong class="segtitle">需要硬盘空间:</strong> <span class=
              "segbody">201 MB</span>
            </div>
          </div>
        </div>
        <div class="admon tip">
          <img alt="[提示]" src="../images/tip.png" />
          <h3>
            Vim 的替代品
          </h3>
          <p>
            如果您喜爱其他编辑器 —— 例如 Emacs、Joe、或者 Nano —— 参考 <a class="ulink" href=
            "http://www.linuxfromscratch.org/blfs/view/svn/postlfs/editors.html">
            http://www.linuxfromscratch.org/blfs/view/svn/postlfs/editors.html</a>
            中建议的安装说明。
          </p>
        </div>
      </div>
      <div class="installation" lang="zh-cn" xml:lang="zh-cn">
        <h2 class="sect2">
          8.69.1. 安装 Vim
        </h2>
        <p>
          首先，修改 <code class="filename">vimrc</code> 配置文件的默认位置为 <code class=
          "filename">/etc</code>：
        </p>
        <pre class="userinput"><kbd class=
        "command">echo '#define SYS_VIMRC_FILE "/etc/vimrc"' &gt;&gt; src/feature.h</kbd></pre>
        <p>
          准备编译 Vim：
        </p>
        <pre class="userinput"><kbd class=
        "command">./configure --prefix=/usr</kbd></pre>
        <p>
          编译该软件包：
        </p>
        <pre class="userinput"><kbd class="command">make</kbd></pre>
        <p>
          为了准备运行测试套件，需要使得 <code class="systemitem">tester</code>
          用户拥有写入源代码目录树的权限：
        </p>
        <pre class="userinput"><kbd class=
        "command">chown -Rv tester .</kbd></pre>
        <p>
          现在，以 <code class="systemitem">tester</code> 用户身份运行测试：
        </p>
        <pre class="userinput"><kbd class=
        "command">su tester -c "LANG=en_US.UTF-8 make -j1 test" &amp;&gt; vim-test.log</kbd></pre>
        <p>
          测试套件会将大量二进制数据输出到屏幕。这可能扰乱当前终端设置。为了避免这个问题，像上面的命令一样，将输出重定向到日志文件。测试成功完成后，日志文件末尾会包含
          “ALL DONE”。
        </p>
        <p>
          安装该软件包：
        </p>
        <pre class="userinput"><kbd class="command">make install</kbd></pre>
        <p>
          许多用户习惯于使用命令 <span class="command"><strong>vi</strong></span>，而不是
          <span class="command"><strong>vim</strong></span>。为了在用户习惯性地输入
          <span class="command"><strong>vi</strong></span> 时能够执行 <span class=
          "command"><strong>vim</strong></span>，为二进制程序和各种语言的 man 页面创建符号链接：
        </p>
        <pre class="userinput"><kbd class="command">ln -sv vim /usr/bin/vi
for L in  /usr/share/man/{,*/}man1/vim.1; do
    ln -sv vim.1 $(dirname $L)/vi.1
done</kbd></pre>
        <p>
          默认情况下，Vim 的文档安装在 <code class="filename">/usr/share/vim</code>
          中。下面创建符号链接，使得可以通过 <code class=
          "filename">/usr/share/doc/vim-8.2.1361</code>
          访问符号链接，这个路径与其他软件包的文档位置格式一致：
        </p>
        <pre class="userinput"><kbd class=
        "command">ln -sv ../vim/vim82/doc /usr/share/doc/vim-8.2.1361</kbd></pre>
        <p>
          如果在安装 LFS 系统后安装了 X 窗口系统，可能需要在安装 X 后重新编译 Vim。Vim 提供的 GUI 版本编辑器需要 X
          和一些额外的软件包才能安装。关于这一安装过程的更多信息，参考 Vim 文档和 BLFS 手册中位于 <a class="ulink"
          href=
          "http://www.linuxfromscratch.org/blfs/view/svn/postlfs/vim.html">http://www.linuxfromscratch.org/blfs/view/svn/postlfs/vim.html</a>
          的 Vim 安装页面。
        </p>
      </div>
      <div class="configuration" lang="zh-cn" xml:lang="zh-cn">
        <h2 class="sect2">
          <a id="conf-vim" name="conf-vim"></a>8.69.2. 配置 Vim
        </h2>
        <p>
          默认情况下，<span class="command"><strong>vim</strong></span> 在不兼容 vi
          的模式下运行。这对于过去使用其他编辑器的用户来说可能显得陌生。以下配置包含的 <span class=
          "quote">“<span class="quote">nocompatible</span>”</span>
          设定是为了强调编辑器使用了新的行为这一事实。它也提醒那些想要使用 <span class="quote">“<span class=
          "quote">compatible</span>”</span>
          模式的用户，必须在配置文件的一开始改变模式。这是因为它会修改其他设置，对这些设置的覆盖必须在设定模式后进行。执行以下命令创建默认
          <span class="command"><strong>vim</strong></span> 配置文件：
        </p>
        <pre class="userinput"><kbd class=
        "command">cat &gt; /etc/vimrc &lt;&lt; "EOF"
<code class="literal">" Begin /etc/vimrc

" Ensure defaults are set before customizing settings, not after
source $VIMRUNTIME/defaults.vim
let skip_defaults_vim=1 

set nocompatible
set backspace=2
set mouse=
syntax on
if (&amp;term == "xterm") || (&amp;term == "putty")
  set background=dark
endif

" End /etc/vimrc</code>
EOF</kbd></pre>
        <p>
          <em class="parameter"><code>set nocompatible</code></em> 设定使得
          <span class="command"><strong>vim</strong></span> 以一种更有用的方式
          (也是默认方式) 行动，而不是兼容于 vi 的旧模式。删除其中的 <span class="quote">“<span class=
          "quote">no</span>”</span> 可以保持旧的 <span class=
          "command"><strong>vi</strong></span> 行为。<em class=
          "parameter"><code>set backspace=2</code></em>
          设定允许退格越过换行，自动缩进，以及插入模式的起始位置。参数 <em class="parameter"><code>syntax
          on</code></em> 启用 vim 符号高亮功能。参数 <em class="parameter"><code>set
          mouse=</code></em> 允许在 chroot
          中或通过远程连接工作时使用鼠标正确地粘贴文本。最后，<span class="emphasis"><em>if</em></span>
          语句为 <em class="parameter"><code>set background=dark</code></em> 纠正
          <span class="command"><strong>vim</strong></span>
          对于某些终端模拟器背景色的猜测。这能够提供更适合这些程序黑色背景的配色方案。
        </p>
        <p>
          关于其他可用选项的文档可以通过执行以下命令获得：
        </p>
        <pre class="userinput"><kbd class=
        "command">vim -c ':options'</kbd></pre>
        <div class="admon note">
          <img alt="[注意]" src="../images/note.png" />
          <h3>
            注意
          </h3>
          <p>
            默认情况下 Vim 只安装英语拼写检查文件。如果希望安装您使用的语言的拼写检查文件，需要获取使用于您的语言和字符编码的
            <code class="filename">*.spl</code> 和可选的 <code class=
            "filename">*.sug</code> 文件，从 <a class="ulink" href=
            "ftp://ftp.vim.org/pub/vim/runtime/spell/">ftp://ftp.vim.org/pub/vim/runtime/spell/</a>
            下载它们，并保存到 <code class=
            "filename">/usr/share/vim/vim82/spell/</code>。
          </p>
          <p>
            为了使用这些拼写检查文件，需要在 <code class="filename">/etc/vimrc</code>
            中进行配置，例如：
          </p>
          <pre class="screen"><code class="literal">set spelllang=en,ru
set spell</code></pre>
          <p>
            关于更多信息，参考以上 URL 位置中合适的 README 文件。
          </p>
        </div>
      </div>
      <div class="content" lang="zh-cn" xml:lang="zh-cn">
        <h2 class="sect2">
          <a id="contents-vim" name="contents-vim"></a>8.69.3. Vim 的内容
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">安装的程序:</strong> <span class=
              "segbody">ex (到 vim 的链接), rview (到 vim 的链接), rvim (到 vim 的链接),
              vi (到 vim 的链接), view (到 vim 的链接), vim, vimdiff (到 vim 的链接),
              vimtutor, 以及 xxd</span>
            </div>
            <div class="seg">
              <strong class="segtitle">安装的目录:</strong> <span class=
              "segbody">/usr/share/vim</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            简要描述
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="ex" name="ex"></a><span class="term"><span class=
                    "command"><strong>ex</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    以 ex 模式启动 <span class=
                    "command"><strong>vim</strong></span>
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="rview" name="rview"></a><span class=
                    "term"><span class=
                    "command"><strong>rview</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    是 <span class="command"><strong>view</strong></span>
                    的受限模式；不能启动 shell 命令，且不能挂起 <span class=
                    "command"><strong>view</strong></span>
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="rvim" name="rvim"></a><span class=
                    "term"><span class=
                    "command"><strong>rvim</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    是 <span class="command"><strong>vim</strong></span>
                    的受限模式；不能启动 shell 命令，且不能挂起 <span class=
                    "command"><strong>vim</strong></span>
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="vi" name="vi"></a><span class="term"><span class=
                    "command"><strong>vi</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    到 <span class="command"><strong>vim</strong></span> 的链接
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="view" name="view"></a><span class=
                    "term"><span class=
                    "command"><strong>view</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    以只读模式启动 <span class="command"><strong>vim</strong></span>
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="vim" name="vim"></a><span class=
                    "term"><span class="command"><strong>vim</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    文本编辑器
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="vimdiff" name="vimdiff"></a><span class=
                    "term"><span class=
                    "command"><strong>vimdiff</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    用 <span class="command"><strong>vim</strong></span>
                    编辑两个或三个文件版本，并显示差异
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="vimtutor" name="vimtutor"></a><span class=
                    "term"><span class=
                    "command"><strong>vimtutor</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    教会用户使用 <span class="command"><strong>vim</strong></span>
                    的基本快捷键和命令
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="xxd" name="xxd"></a><span class=
                    "term"><span class="command"><strong>xxd</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    创建文件的十六进制转储；它也可以从十六进制转储创建文件，因此可用于二进制补丁
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="texinfo.html" title="Texinfo-6.7">上一页</a>
          <p>
            Texinfo-6.7
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="systemd.html" title="Systemd-246">下一页</a>
          <p>
            Systemd-246
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter08.html" title=
          "第&nbsp;8&nbsp;章&nbsp;安装基本系统软件">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200927-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
