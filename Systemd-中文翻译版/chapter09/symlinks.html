<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      9.4.&nbsp;管理设备
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="lfs" id="lfs-20200927-systemd，中文翻译版">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 20200927-systemd，中文翻译版
      </h4>
      <h3>
        第&nbsp;9&nbsp;章&nbsp;系统配置
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="udev.html" title="设备和模块管理概述">上一页</a>
          <p>
            设备和模块管理概述
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="clock.html" title="配置系统时钟">下一页</a>
          <p>
            配置系统时钟
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter09.html" title=
          "第&nbsp;9&nbsp;章&nbsp;系统配置">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200927-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-config-symlinks" name="ch-config-symlinks"></a>9.4. 管理设备
      </h1>
      <div class="sect2" lang="zh-cn" xml:lang="zh-cn">
        <h2 class="sect2">
          9.4.1. 处理重复设备
        </h2>
        <p>
          正如<a class="xref" href="udev.html" title=
          "9.3.&nbsp;设备和模块管理概述">第&nbsp;9.3&nbsp;节
          “设备和模块管理概述”</a>中所述，那些功能相同的设备在 <code class="filename">/dev</code>
          中的顺序是随机的。例如，如果您有一个 USB 摄像头和一个电视棒，有时 <code class=
          "filename">/dev/video0</code> 会指向摄像头，<code class=
          "filename">/dev/video1</code>
          指向电视棒，而有时在重启后这个顺序正好颠倒过来。对于所有除了声卡和网卡以外的设备，该问题都可以通过创建自定义持久化符号链接的 Udev
          规则来解决。对于网卡的解决方案在<a class="xref" href="network.html" title=
          "9.2.&nbsp;一般网络配置">第&nbsp;9.2&nbsp;节 “一般网络配置”</a>中单独描述，而声卡配置可以在
          <a class="ulink" href=
          "http://www.linuxfromscratch.org/blfs/view/svn/postlfs/devices.html">
          BLFS</a> 中找到。
        </p>
        <p>
          对于您的每个可能有这类问题的设备 (即使在您当前使用的 Linux 发行版上并没有问题)，找到 <code class=
          "filename">/sys/class</code> 或 <code class=
          "filename">/sys/block</code> 中的对应目录。对于视频设备，目录可能是 <code class=
          "filename">/sys/class/video4linux/video<em class=
          "replaceable"><code>X</code></em></code>。找出能够唯一确认该设备的属性 (通常是厂商和产品
          ID，或者序列号)：
        </p>
        <pre class="userinput"><kbd class=
        "command">udevadm info -a -p /sys/class/video4linux/video0</kbd></pre>
        <p>
          然后编写创建符号链接的规则，例如：
        </p>
        <pre class="userinput"><kbd class=
        "command">cat &gt; /etc/udev/rules.d/83-duplicate_devs.rules &lt;&lt; "EOF"
<code class="literal">
# 摄像头和电视棒的持久化符号链接
KERNEL=="video*", ATTRS{idProduct}=="1910", ATTRS{idVendor}=="0d81", SYMLINK+="webcam"
KERNEL=="video*", ATTRS{device}=="0x036f",  ATTRS{vendor}=="0x109e", SYMLINK+="tvtuner"
</code>
EOF</kbd></pre>
        <p>
          结果是，<code class="filename">/dev/video0</code> 和 <code class=
          "filename">/dev/video1</code> 仍然会随机指向电视棒和摄像头 (因此不应直接使用它们)，但符号链接
          <code class="filename">/dev/tvtuner</code> 和 <code class=
          "filename">/dev/webcam</code> 总会指向正确设备。
        </p>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="udev.html" title="设备和模块管理概述">上一页</a>
          <p>
            设备和模块管理概述
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="clock.html" title="配置系统时钟">下一页</a>
          <p>
            配置系统时钟
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter09.html" title=
          "第&nbsp;9&nbsp;章&nbsp;系统配置">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200927-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
