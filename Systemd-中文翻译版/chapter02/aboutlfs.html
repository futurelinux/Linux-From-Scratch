<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      2.6.&nbsp;设置 $LFS 环境变量
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="lfs" id="lfs-20200927-systemd，中文翻译版">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 20200927-systemd，中文翻译版
      </h4>
      <h3>
        第&nbsp;2&nbsp;章&nbsp;准备宿主系统
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="creatingfilesystem.html" title=
          "在分区上建立文件系统">上一页</a>
          <p>
            在分区上建立文件系统
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="mounting.html" title="挂载新的分区">下一页</a>
          <p>
            挂载新的分区
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter02.html" title=
          "第&nbsp;2&nbsp;章&nbsp;准备宿主系统">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200927-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-partitioning-aboutlfs" name=
        "ch-partitioning-aboutlfs"></a>2.6. 设置 $LFS 环境变量
      </h1>
      <p>
        在本书中，我们经常使用环境变量 <code class="envar">LFS</code>。您应该保证，在构建 LFS
        的全过程中，该变量都被定义且设置为您构建 LFS 使用的目录 —— 我们使用 <code class=
        "filename">/mnt/lfs</code> 作为例子，但您可以选择其他目录。如果您在一个独立的分区上构建
        LFS，那么这个目录将成为该分区的挂载点。选择一个目录，然后用以下命令设置环境变量：
      </p>
      <pre class="userinput"><kbd class="command">export LFS=<em class=
      "replaceable"><code>/mnt/lfs</code></em></kbd></pre>
      <p>
        设置该环境变量的好处是，我们可以直接输入书中的命令，例如 <span class="command"><strong>mkdir -v
        $LFS/tools</strong></span>。Shell 在解析命令时会自动将 <span class=
        "quote">“<span class="quote">$LFS</span>”</span> 替换成 <span class=
        "quote">“<span class="quote">/mnt/lfs</span>”</span> (或是您设置的其他值)。
      </p>
      <div class="admon caution">
        <img alt="[小心]" src="../images/caution.png" />
        <h3>
          小心
        </h3>
        <p>
          无论何时，如果您离开并重新进入了工作环境，一定要确认 <code class="envar">LFS</code>
          的设定值和您离开工作环境时相同。(例如，使用 <span class=
          "command"><strong>su</strong></span> 切换到 <code class=
          "systemitem">root</code> 或者其他用户时。) 请执行以下命令，检查 <code class=
          "envar">LFS</code> 的设置是否正确：
        </p>
        <pre class="userinput"><kbd class="command">echo $LFS</kbd></pre>
        <p>
          确认该命令的输出是您构建 LFS 的位置，如果您使用本书提供的例子，那么输出应该是 <code class=
          "filename">/mnt/lfs</code>。如果输出不正确，使用前文给出的命令，将 <code class=
          "envar">$LFS</code> 设置成正确的目录名。
        </p>
      </div>
      <div class="admon note">
        <img alt="[注意]" src="../images/note.png" />
        <h3>
          注意
        </h3>
        <p>
          确保 <code class="envar">LFS</code> 始终正确的一种方法是：编辑您的主目录中的 <code class=
          "filename">.bash_profile</code>，以及<code class=
          "filename">/root/.bash_profile</code>，为它们加入上述设置并导出 LFS 变量的 export
          命令。还要确认 <code class="filename">/etc/passwd</code> 中为每个需要使用
          <code class="envar">LFS</code> 变量的用户指定的 shell 都是 bash，以保证每次登录时都执行
          <code class="filename">.bash_profile</code> 中的命令。
        </p>
        <p>
          另外还要考虑登录宿主系统的方式，如果您使用图形显示管理器登录，再启动虚拟终端，那么 <code class=
          "filename">.bash_profile</code> 一般不会被虚拟终端执行。此时，应该将 export
          命令加入到您使用的用户和 root 用户的 <code class="filename">.bashrc</code>
          文件中。另外，如果以非交互模式启动 bash，有的发行版不会执行 <code class=
          "filename">.bashrc</code> 中的指令。此时一定要在使用环境变量前添加 export 命令。
        </p>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="creatingfilesystem.html" title=
          "在分区上建立文件系统">上一页</a>
          <p>
            在分区上建立文件系统
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="mounting.html" title="挂载新的分区">下一页</a>
          <p>
            挂载新的分区
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter02.html" title=
          "第&nbsp;2&nbsp;章&nbsp;准备宿主系统">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200927-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
