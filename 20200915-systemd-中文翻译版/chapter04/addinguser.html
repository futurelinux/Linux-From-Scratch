<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      4.3.&nbsp;添加 LFS 用户
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="lfs" id="lfs-20200915-systemd，中文翻译版">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 20200915-systemd，中文翻译版
      </h4>
      <h3>
        第&nbsp;4&nbsp;章&nbsp;最后准备工作
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="creatingminlayout.html" title=
          "在 LFS 文件系统中创建有限目录布局">上一页</a>
          <p>
            在 LFS 文件系统中创建有限目录布局
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="settingenvironment.html" title=
          "配置环境">下一页</a>
          <p>
            配置环境
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter04.html" title=
          "第&nbsp;4&nbsp;章&nbsp;最后准备工作">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200915-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-preps-addinguser" name="ch-preps-addinguser"></a>4.3. 添加
        LFS 用户
      </h1>
      <p>
        在作为 <code class="systemitem">root</code>
        用户登录时，一个微小的错误就可能损坏甚至摧毁整个系统。因此，我们建议在后续两章中，以非特权用户身份编译软件包。您可以使用自己的系统用户，但为了更容易地建立一个干净的工作环境，最好创建一个名为
        <code class="systemitem">lfs</code> 的新用户，以及它从属于的一个新组 (组名也是
        <code class="systemitem">lfs</code>)，以便我们在安装过程中使用。为了创建新用户，以
        <code class="systemitem">root</code> 身份执行以下命令：
      </p>
      <pre class="userinput"><kbd class="command">groupadd lfs
useradd -s /bin/bash -g lfs -m -k /dev/null lfs</kbd></pre>
      <div class="variablelist">
        <p class="title">
          <strong>命令行各选项的含义:</strong>
        </p>
        <dl class="variablelist">
          <dt>
            <span class="term"><em class="parameter"><code>-s
            /bin/bash</code></em></span>
          </dt>
          <dd>
            <p>
              设置 <span class="command"><strong>bash</strong></span> 为用户
              <code class="systemitem">lfs</code> 的默认 shell。
            </p>
          </dd>
          <dt>
            <span class="term"><em class="parameter"><code>-g
            lfs</code></em></span>
          </dt>
          <dd>
            <p>
              添加用户 <code class="systemitem">lfs</code> 到组 <code class=
              "systemitem">lfs</code>。
            </p>
          </dd>
          <dt>
            <span class="term"><em class=
            "parameter"><code>-m</code></em></span>
          </dt>
          <dd>
            <p>
              为用户 <code class="systemitem">lfs</code> 创建一个主目录。
            </p>
          </dd>
          <dt>
            <span class="term"><em class="parameter"><code>-k
            /dev/null</code></em></span>
          </dt>
          <dd>
            <p>
              将模板目录设置为空设备文件，从而不从默认模板目录 (<code class=
              "filename">/etc/skel</code>) 复制文件到新的主目录。
            </p>
          </dd>
          <dt>
            <span class="term"><em class=
            "parameter"><code>lfs</code></em></span>
          </dt>
          <dd>
            <p>
              要创建的用户的名称。
            </p>
          </dd>
        </dl>
      </div>
      <p>
        为了以 <code class="systemitem">lfs</code> 身份登录系统 (尽管以 <code class=
        "systemitem">root</code> 身份登录时可以不用输入密码，直接切换到用户 <code class=
        "systemitem">lfs</code>)，为 <code class="systemitem">lfs</code> 设置密码：
      </p>
      <pre class="userinput"><kbd class="command">passwd lfs</kbd></pre>
      <p>
        将 <code class="systemitem">lfs</code> 设为 <code class=
        "filename">$LFS</code> 中所有目录的所有者，使 <code class=
        "systemitem">lfs</code> 对它们拥有完全访问权：
      </p>
      <pre class="userinput"><kbd class=
      "command">chown -v lfs $LFS/{usr,lib,var,etc,bin,sbin,tools}
case $(uname -m) in
  x86_64) chown -v lfs $LFS/lib64 ;;
esac</kbd></pre>
      <p>
        如果您按照本书的建议，建立了一个单独的工作目录，那么将这个目录的所有者也设为 <code class=
        "systemitem">lfs</code>：
      </p>
      <pre class="userinput"><kbd class=
      "command">chown -v lfs $LFS/sources</kbd></pre>
      <div class="admon note">
        <img alt="[注意]" src="../images/note.png" />
        <h3>
          注意
        </h3>
        <p>
          在某些宿主系统上，下面的命令不会正确完成，而会将 lfs 用户的登录会话挂起到后台。如果提示符 “lfs:~$” 没有很快出现，输入
          <span class="command"><strong>fg</strong></span> 命令以修复这个问题。
        </p>
      </div>
      <p>
        下面以 <code class="systemitem">lfs</code>
        的身份登录。可以通过虚拟控制台或者显示管理器登录，也可以使用下面的命令切换用户：
      </p>
      <pre class="userinput"><kbd class="command">su - lfs</kbd></pre>
      <p>
        参数 <span class="quote">“<span class="quote"><em class=
        "parameter"><code>-</code></em></span>”</span> 使得 <span class=
        "command"><strong>su</strong></span> 启动一个登录 shell，而不是非登录 shell。您可以阅读
        <code class="filename">bash(1)</code> 和 <span class=
        "command"><strong>info bash</strong></span> 详细了解它们的区别。
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="creatingminlayout.html" title=
          "在 LFS 文件系统中创建有限目录布局">上一页</a>
          <p>
            在 LFS 文件系统中创建有限目录布局
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="settingenvironment.html" title=
          "配置环境">下一页</a>
          <p>
            配置环境
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter04.html" title=
          "第&nbsp;4&nbsp;章&nbsp;最后准备工作">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200915-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
