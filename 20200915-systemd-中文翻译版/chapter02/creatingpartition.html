<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      2.4.&nbsp;创建新的分区
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="lfs" id="lfs-20200915-systemd，中文翻译版">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 20200915-systemd，中文翻译版
      </h4>
      <h3>
        第&nbsp;2&nbsp;章&nbsp;准备宿主系统
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="stages.html" title="分阶段构建 LFS">上一页</a>
          <p>
            分阶段构建 LFS
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="creatingfilesystem.html" title=
          "在分区上建立文件系统">下一页</a>
          <p>
            在分区上建立文件系统
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter02.html" title=
          "第&nbsp;2&nbsp;章&nbsp;准备宿主系统">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200915-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-partitioning-creatingpartition" name=
        "ch-partitioning-creatingpartition"></a>2.4. 创建新的分区
      </h1>
      <p>
        像其他操作系统那样，LFS 一般也被安装在一个专用的分区。我们推荐您为 LFS
        选择一个可用的空分区，或者在有充足未划分空间的情况下，创建一个新分区。
      </p>
      <p>
        一个最小的系统需要大小约 10 吉字节 (GB) 的分区。这足够保存所有源代码压缩包，并且编译所有软件包。然而，如果希望用 LFS
        作为日常的 Linux 系统，很可能需要安装额外软件，需要更多空间。一个 30 GB 的分区是比较合理的。LFS
        系统本身用不了太多空间，但大分区可以提供足够的临时存储空间，以及在 LFS
        构建完成后增添附加功能需要的空间。另外，编译软件包可能需要大量磁盘空间，但在软件包安装完成后可以回收这些空间。
      </p>
      <p>
        计算机未必有足够满足编译过程要求的内存 (RAM) 空间，因此可以使用一个小的磁盘分区作为 <code class=
        "systemitem">swap</code> 空间。内核使用此分区存储很少使用的数据，从而为活动进程留出更多内存。LFS 的
        <code class="systemitem">swap</code> 分区可以和宿主系统共用，这样就不用专门为 LFS 创建一个。
      </p>
      <p>
        启动一个磁盘分区程序，例如 <span class="command"><strong>cfdisk</strong></span>
        或者<span class=
        "command"><strong>fdisk</strong></span>。在启动分区程序时需要一个命令行参数，表示希望创建新分区的硬盘，例如主硬盘
        <code class="filename">/dev/sda</code>。创建一个 Linux 原生分区，如果有必要的话再创建一个
        <code class="systemitem">swap</code> 分区。请参考 <code class=
        "filename">cfdisk(8)</code> 或者 <code class="filename">fdisk(8)</code>
        来学习如何使用分区程序。
      </p>
      <div class="admon note">
        <img alt="[注意]" src="../images/note.png" />
        <h3>
          注意
        </h3>
        <p>
          有经验的用户可以尝试其他分区架构。LFS 系统可以被构建在软件 <a class="ulink" href=
          "http://www.linuxfromscratch.org/blfs/view/svn/postlfs/raid.html">RAID</a>
          阵列或 <a class="ulink" href=
          "http://www.linuxfromscratch.org/blfs/view/svn/postlfs/aboutlvm.html">
          LVM</a> 逻辑卷上。然而，一些分区架构需要 <a class="ulink" href=
          "http://www.linuxfromscratch.org/blfs/view/svn/postlfs/initramfs.html">
          initramfs</a>，这是一个比较复杂的话题。对于初次构建 LFS 的用户来说，不推荐采用这些分区方法。
        </p>
      </div>
      <p>
        牢记新分区的代号 (例如 <code class="filename">sda5</code> )。本书将这个分区称为 LFS
        分区。还需要记住 <code class="systemitem">swap</code> 分区的代号。之后在设置
        <code class="filename">/etc/fstab</code> 文件时要用到这些代号。
      </p>
      <div class="sect2" lang="zh-cn" xml:lang="zh-cn">
        <h2 class="sect2">
          2.4.1. 其他分区问题
        </h2>
        <p>
          经常有人在 LFS 邮件列表询问如何进行系统分区。这是一个相当主观的问题。许多发行版在默认情况下会使用整个磁盘，只留下一个小的
          swap 分区。对于 LFS 来说，这往往不是最好的方案。它削弱了系统的灵活性，使得我们难以在多个发行版或 LFS
          系统之间共享数据，增加系统备份时间，同时导致文件系统结构的不合理分配，浪费磁盘空间。
        </p>
        <div class="sect3">
          <h3 class="sect3">
            2.4.1.1. 根分区
          </h3>
          <p>
            一个 LFS 根分区 (不要与 <code class="filename">/root</code> 目录混淆) 一般分配 20
            GB 的空间就足以保证多数系统的运行。它提供了构建 LFS 以及 BLFS
            的大部分软件包的充足空间，但又不太大，因此能够创建多个分区，多次尝试构建 LFS 系统。
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            2.4.1.2. 交换 (Swap) 分区
          </h3>
          <p>
            许多发行版自动创建交换空间。一般来说，推荐采用两倍于物理内存的交换空间，然而这几乎没有必要。如果磁盘空间有限，可以创建不超过
            2GB 的交换空间，并注意它的使用情况。
          </p>
          <p>
            如果您希望使用 Linux 的休眠功能
            (挂起到磁盘)，它会在关机前将内存内容写入到交换分区。这种情况下，交换分区的大小应该至少和系统内存相同。
          </p>
          <p>
            交换到磁盘从来就不是一件好事。对于机械硬盘，通过听硬盘的工作噪声，同时观察系统的响应速度，就能说出系统是否在交换。对于
            SSD，您无法听到工作噪声，但可以使用<span class=
            "command"><strong>top</strong></span> 或 <span class=
            "command"><strong>free</strong></span> 程序查看使用了多少交换空间。应该尽量避免使用 SSD
            设备作为交换分区。一旦发生交换，首先检查是否输入了不合理的命令，例如试图编辑一个 5GB
            的文件。如果交换时常发生，最好的办法是为你的系统添置内存。
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            2.4.1.3. Grub Bios 分区
          </h3>
          <p>
            如果 <span class="emphasis"><em>启动磁盘</em></span> 采用 GUID 分区表
            (GPT)，那么必须创建一个小的，一般占据 1MB 的分区，除非它已经存在。这个分区不能格式化，在安装启动引导器时必须能够被
            GRUB 发现。这个分区在 <span class="command"><strong>fdisk</strong></span>
            下显示为 'BIOS Boot' 分区，在 <span class=
            "command"><strong>gdisk</strong></span> 下显示分区类型代号为 <span class=
            "emphasis"><em>EF02</em></span>。
          </p>
          <div class="admon note">
            <img alt="[注意]" src="../images/note.png" />
            <h3>
              注意
            </h3>
            <p>
              Grub Bios 分区必须位于 BIOS 引导系统使用的磁盘上。这个磁盘未必是 LFS
              根分区所在的磁盘。不同磁盘可以使用不同分区表格式，只有引导盘采用 GPT 时才必须创建该分区。
            </p>
          </div>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            2.4.1.4. 常用分区
          </h3>
          <p>
            还有其他几个并非必须，但在设计磁盘布局时应当考虑的分区。下面的列表并不完整，但可以作为一个参考。
          </p>
          <div class="itemizedlist">
            <ul>
              <li class="listitem">
                <p>
                  boot – 高度推荐。这个分区可以存储内核和其他引导信息。为了减少大磁盘可能引起的问题，建议将 /boot
                  分区设为第一块磁盘的第一个分区。为它分配 200 MB 就绰绰有余。
                </p>
              </li>
              <li class="listitem">
                <p>
                  /home – 高度推荐。独立的 /home 分区可以在多个发行版或 LFS 系统之间共享 home
                  目录和用户设置。它的尺寸一般很大，取决于硬盘的可用空间。
                </p>
              </li>
              <li class="listitem">
                <p>
                  /usr – 一个独立的 /usr 分区一般被用于瘦客户端或无盘站的服务器，LFS 一般不需要。为它划分 10GB
                  足够满足多数系统的要求。
                </p>
              </li>
              <li class="listitem">
                <p>
                  /opt – 这个目录往往被用于在 BLFS 中安装 Gnome 或 KDE 等大型软件，以免把大量文件塞进 /usr
                  目录树。如果将它划分为独立分区，5 到 10 GB 一般就足够了。
                </p>
              </li>
              <li class="listitem">
                <p>
                  /tmp – 一个独立的 /tmp 分区是很少见的，但在配置瘦客户端时很有用。如果分配了这个分区，大小一般不会超过几个
                  GB。
                </p>
              </li>
              <li class="listitem">
                <p>
                  /usr/src – 将它划分为独立分区，可以用于存储 BLFS 源代码，并在多个 LFS
                  系统之间共享它们。它也可以用于编译 BLFS 软件包。30-50 GB 的分区可以提供足够的空间。
                </p>
              </li>
            </ul>
          </div>
          <p>
            如果您希望在启动时自动挂载任何一个独立的分区，就要在 <code class=
            "filename">/etc/fstab</code> 文件中说明。有关指定分区的细节将在 <a class="xref"
            href="../chapter10/fstab.html" title=
            "10.2.&nbsp;创建 /etc/fstab 文件">第&nbsp;10.2&nbsp;节 “创建 /etc/fstab
            文件”</a> 中讨论。
          </p>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="stages.html" title="分阶段构建 LFS">上一页</a>
          <p>
            分阶段构建 LFS
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="creatingfilesystem.html" title=
          "在分区上建立文件系统">下一页</a>
          <p>
            在分区上建立文件系统
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter02.html" title=
          "第&nbsp;2&nbsp;章&nbsp;准备宿主系统">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 20200915-systemd，中文翻译版">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
